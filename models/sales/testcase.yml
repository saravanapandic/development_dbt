version: 2
sources:
  - name: sample_increment
    description: source tpch data
    database: DBT_GITHUB
    schema: SALES_DETAILS
    tables:
      - name: OFFLINE_SALES
        description: offline sales details 
        tests:
          - dbt_expectations.expect_table_column_count_to_be_between:
             min_value: 1
             max_value: 15
          - dbt_expectations.expect_table_columns_to_contain_set:
              column_list: ["REGION", "COUNTRY","ITEM_TYPE","SALES_TYPE","ORDER_PRIORITY","ORDER_DATE","ORDER_ID","SHIP_DATE"]
          - dbt_expectations.expect_table_column_count_to_equal:
              value: 15
          - dbt_expectations.expect_table_columns_to_match_ordered_list:
              column_list: ["REGION", "COUNTRY","ITEM_TYPE","SALES_TYPE","ORDER_PRIORITY","ORDER_DATE","ORDER_ID","SHIP_DATE","UNITS_SOLD","UNITS_PRICE","UNIT_COST","TOTAL_REVENUE","TOTAL_COST","TOTAL_PROFIT","DATE_DIFFERENCE"]
          - dbt_expectations.expect_table_row_count_to_be_between:
             min_value: 1 # (Optional)
             max_value: 180000 # (Optional)
          - dbt_expectations.expect_table_row_count_to_equal:
              value: 180000
        columns:
          - name: REGION
            description: region 
            tests: 
              - not_null
              - dbt_expectations.expect_column_values_to_be_of_type:
                  column_type: number 

           

          